FROM pentest-base

# Install pwntools
RUN pip install --no-cache-dir pwntools

# Install debugging tools
RUN apt-get install -y \
    gdb

# Install gdb-peda
RUN git clone https://github.com/longld/peda.git /opt/peda \
    && echo "source /opt/peda/peda.py" >> ~/.gdbinit

# Install hexeditor
# RUN git clone https://github.com/b3ad/hexeditor.git /opt/hexeditor \
#     && chmod +x /opt/hexeditor/hexeditor \
#     && ln -s /opt/hexeditor/hexeditor /usr/local/bin/hexeditor

# Install auxiliary tools
RUN apt-get install -y \
    binwalk \
    foremost \
    vbindiff

# Add 32-bit architecture support
RUN dpkg --add-architecture i386 \
    && apt-get update

# Add checksec.sh
RUN apt-get install -y dos2unix \
    && wget http://www.trapkit.de/tools/checksec.sh -O - | dos2unix > /usr/local/bin/checksec \
    && chmod +x /usr/local/bin/checksec

# Add frida
RUN pip3 install --no-cache-dir frida frida-tools

# Install radare2
RUN git clone https://github.com/radare/radare2.git \
    && cd radare2 \
    && sys/install.sh

WORKDIR /root
ENTRYPOINT ["/usr/bin/zsh"]
