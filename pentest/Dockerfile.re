FROM kalilinux/kali-linux-docker

# Use a more reliable mirror
RUN sed -i 's/http.kali.org/kali.cs.nctu.edu.tw/g' /etc/apt/sources.list \
    && apt-get update

# Install common tools
RUN apt-get install -y \
    man-db \
    vim less \
    ca-certificates git curl \
    zip unzip \
    openssh-client

# Install common runtime languages
RUN apt-get install -y \
    python python-pip \
    python3 python3-pip

# Install metasploit-framework
RUN apt-get install -y metasploit-framework

# Install pwntools
RUN pip install --no-cache-dir pwntools

# Install debugging tools
RUN apt-get install -y \
    gdb

# Install gdb-peda
RUN git clone https://github.com/longld/peda.git /opt/peda \
    && echo "source ~/peda/peda.py" >> /opt/.gdbinit

# Install auxiliary tools
RUN apt-get install -y \
    binwalk \
    foremost \
    vbindiff \
    hexeditor

# Add 32-bit architecture support
RUN dpkg --add-architecture i386 \
    && apt-get update
