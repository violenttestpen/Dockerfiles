FROM kalilinux/kali-linux-docker

# Use a more reliable mirror
RUN sed -i 's/http.kali.org/kali.cs.nctu.edu.tw/g' /etc/apt/sources.list \
    && apt-get update

# Install common tools
RUN apt-get install -y \
    man-db \
    vim less \
    ca-certificates git curl \
    zip unzip \
    openssh-client

# Install common runtime languages
RUN apt-get install -y \
    python python-pip \
    python3 python3-pip

# Install metasploit-framework
RUN apt-get install -y metasploit-framework

# Install common reconnaissance tools
RUN apt-get install -y \
    nmap \
    ncat

# Install common web enumeration tools
RUN apt-get install -y \
    nikto \
    dirb \
    sqlmap \
    wpscan

# Install common cracking tools
RUN apt-get install -y \
    wordlists \
    hydra \
    john

# Install common auxiliary tools
RUN apt-get install -y \
    exploitdb \
    weevely \
    webshells \
    unix-privesc-check \
    hash-identifier \
    findmyhash

# Install Linux-Exploit-Suggester
RUN git clone https://github.com/mzet-/linux-exploit-suggester.git /opt/linux-exploit-suggester \
    && chmod +x /opt/linux-exploit-suggester/linux-exploit-suggester.sh \
    && ln -s /opt/linux-exploit-suggester/linux-exploit-suggester.sh /usr/local/bin/linux-exploit-suggester

# Create known_hosts for git cloning
RUN mkdir -p /root/.ssh \
    && touch /root/.ssh/known_hosts
# Add host keys
RUN ssh-keyscan bitbucket.org >> /root/.ssh/known_hosts
RUN ssh-keyscan github.com >> /root/.ssh/known_hosts

EXPOSE 80/tcp 443/tcp
