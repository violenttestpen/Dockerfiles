FROM debian:jessie

# Add Kali repositories
RUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys ED444FF07D8D0BF6
RUN echo deb http://kali.cs.nctu.edu.tw/kali kali-rolling main contrib non-free > /etc/apt/sources.list \
    && echo deb-src http://kali.cs.nctu.edu.tw/kali kali-rolling main contrib non-free >> /etc/apt/sources.list \
    && apt-get update

# Use a more reliable mirror
# RUN sed -i 's/http.kali.org/kali.cs.nctu.edu.tw/g' /etc/apt/sources.list \
#     && apt-get update

# Intall zsh as our default shell
ENV ZSH_THEME agnoster
RUN apt-get install -y curl git locales zsh fonts-powerline \
    && sed -i 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/g' /etc/locale.gen \
    && locale-gen en_US.UTF-8 \
    && sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)" || echo true \
    && sed -i 's/ZSH_THEME="robbyrussell"/ZSH_THEME="$ZSH_THEME"/g' /root/.zshrc \
    && chsh -s /usr/bin/zsh

# Install common tools
RUN apt-get install -y \
    net-tools \
    man-db \
    vim less \
    ca-certificates git curl \
    zip unzip \
    openssh-client

# Install common runtime languages
RUN apt-get install -y \
    python python-pip \
    python3 python3-pip

# Intall WiFi analysis tools
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y \
    wireshark

# Install common WiFi tools
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y \
    macchanger

# Install WiFi security tools
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y \
    kmod \
    pciutils \
    aircrack-ng \
    reaver \
    cowpatty \
    wifite \
    pyrit \
    bully \
    mdk3

WORKDIR /root
ENTRYPOINT ["/usr/bin/zsh"]
